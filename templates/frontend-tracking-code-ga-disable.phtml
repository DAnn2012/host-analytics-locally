<?php
/* * * * * * * * * * * * * * * * * * * *
 *  ██████╗ █████╗  ██████╗ ███████╗
 * ██╔════╝██╔══██╗██╔═══██╗██╔════╝
 * ██║     ███████║██║   ██║███████╗
 * ██║     ██╔══██║██║   ██║╚════██║
 * ╚██████╗██║  ██║╚██████╔╝███████║
 *  ╚═════╝╚═╝  ╚═╝ ╚═════╝ ╚══════╝
 *
 * @author   : Daan van den Bergh
 * @url      : https://daan.dev/wordpress/caos/
 * @copyright: (c) 2021 Daan van den Bergh
 * @license  : GPL2v2 or later
 * * * * * * * * * * * * * * * * * * * */
$tracking_id    = \CAOS\Plugin::get(\CAOS\Admin\Settings::CAOS_BASIC_SETTING_TRACKING_ID);
$allow_tracking = \CAOS\Plugin::get(\CAOS\Admin\Settings::CAOS_BASIC_SETTING_ALLOW_TRACKING);
$cookie_name    = \CAOS\Plugin::get(\CAOS\Admin\Settings::CAOS_BASIC_SETTING_COOKIE_NAME);
$cookie_value   = \CAOS\Plugin::get(\CAOS\Admin\Settings::CAOS_BASIC_SETTING_COOKIE_VALUE);
?>
<script>
    <?php if ($allow_tracking === 'cookie_is_set' && $cookie_name) : ?>
        if (document.cookie.indexOf('<?= $cookie_name; ?>=') === -1) {
            window['ga-disable-<?= $tracking_id; ?>'] = true;
        }
    <?php elseif ($allow_tracking === 'cookie_is_not_set' && $cookie_name) : ?>
        if (document.cookie.indexOf('<?= $cookie_name; ?>=') !== -1) {
            window['ga-disable-<?= $tracking_id; ?>'] = true;
        }
    <?php elseif ($allow_tracking === 'cookie_has_value' && $cookie_name && $cookie_value) : ?>
        if (cookieValue !== '<?= $cookie_value; ?>') {
            window['ga-disable-<?= $tracking_id; ?>'] = true;
        }
    <?php elseif ($allow_tracking === 'cookie_value_contains' && $cookie_name && $cookie_value) : ?>
        if (cookieValue !== null && !cookieValue.includes('<?= $cookie_value; ?>')) {
            window['ga-disable-<?= $tracking_id; ?>'] = true;
        }
    <?php endif; ?>
</script>